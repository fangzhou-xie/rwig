<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>WDL Model • wig</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="WDL Model">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">wig</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/sinkhorn.html">Sinkhorn Algorithms</a></li>
    <li><a class="dropdown-item" href="../articles/barycenter.html">Barycenter Algorithms</a></li>
    <li><a class="dropdown-item" href="../articles/wdl-model.html">WDL Model</a></li>
    <li><a class="dropdown-item" href="../articles/wig-model.html">WIG Model</a></li>
    <li><a class="dropdown-item" href="../articles/specs.html">WDL and WIG Model Specs</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Advanced Topics</h6></li>
    <li><a class="dropdown-item" href="../articles/threading.html">Multi-threading Support</a></li>
    <li><a class="dropdown-item" href="../articles/gradient.html">Computation of the Gradients</a></li>
    <li><a class="dropdown-item" href="../articles/tsvd.html">Truncated SVD</a></li>
  </ul>
</li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/fangzhou-xie/wig/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>WDL Model</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/fangzhou-xie/wig/blob/main/vignettes/wdl-model.Rmd" class="external-link"><code>vignettes/wdl-model.Rmd</code></a></small>
      <div class="d-none name"><code>wdl-model.Rmd</code></div>
    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/fangzhou-xie/wig" class="external-link">wig</a></span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/base/message.html" class="external-link">suppressPackageStartupMessages</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p>Let’s say we have some documents as character vectors, and we want to
discover the underlying topics. This is called “topic modeling”, and
Latent Dirichlet Allocation (LDA) is probably the most famous among all
of topic models. Here, we consider the Wasserstein Dicionary Learning
(WDL) model.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># a very simple example</span></span>
<span><span class="va">sentences</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"this is a sentence"</span>, <span class="st">"this is another one"</span><span class="op">)</span></span>
<span><span class="va">wdl_fit</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/wdl.html">wdl</a></span><span class="op">(</span><span class="va">sentences</span><span class="op">)</span></span>
<span><span class="co">#&gt; `method` is automatically switched to "log"</span></span>
<span></span>
<span><span class="va">wdl_fit</span></span>
<span><span class="co">#&gt; WDL model topics:</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Topic 1:</span></span>
<span><span class="co">#&gt;     &lt;/s&gt;     this      one  another sentence </span></span>
<span><span class="co">#&gt;    0.311    0.304    0.108    0.104    0.088 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Topic 2:</span></span>
<span><span class="co">#&gt; another    &lt;/s&gt;     one    this       a </span></span>
<span><span class="co">#&gt;   0.620   0.130   0.111   0.055   0.041 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Topic 3:</span></span>
<span><span class="co">#&gt;     this     &lt;/s&gt;  another       is sentence </span></span>
<span><span class="co">#&gt;    0.358    0.239    0.124    0.114    0.069 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Topic 4:</span></span>
<span><span class="co">#&gt; another    this    &lt;/s&gt;     one      is </span></span>
<span><span class="co">#&gt;   0.343   0.168   0.167   0.121   0.098</span></span></code></pre></div>
<p>We can see from the topics that they are vectors of the tokens
(words) with associated probabilities. If you want to access the topics,
you can do this:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">wdl_fit</span><span class="op">$</span><span class="va">topics</span></span>
<span><span class="co">#&gt;              topic1     topic2     topic3     topic4</span></span>
<span><span class="co">#&gt; a        0.07021960 0.04082612 0.06733181 0.03903212</span></span>
<span><span class="co">#&gt; one      0.10845734 0.11074871 0.02812378 0.12068278</span></span>
<span><span class="co">#&gt; another  0.10403697 0.62005355 0.12403799 0.34305199</span></span>
<span><span class="co">#&gt; sentence 0.08809656 0.02024121 0.06926678 0.06338548</span></span>
<span><span class="co">#&gt; is       0.01420343 0.02331677 0.11404292 0.09835958</span></span>
<span><span class="co">#&gt; this     0.30392984 0.05453664 0.35799228 0.16825826</span></span>
<span><span class="co">#&gt; &lt;/s&gt;     0.31105626 0.13027700 0.23920443 0.16722978</span></span></code></pre></div>
<p>Alternatively, you can also obtain the weights of the topics used to
re-construct the input data:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">wdl_fit</span><span class="op">$</span><span class="va">weights</span></span>
<span><span class="co">#&gt;              [,1]       [,2]</span></span>
<span><span class="co">#&gt; topic1 0.08664043 0.07950508</span></span>
<span><span class="co">#&gt; topic2 0.03458663 0.59189857</span></span>
<span><span class="co">#&gt; topic3 0.05828124 0.07508092</span></span>
<span><span class="co">#&gt; topic4 0.82049170 0.25351543</span></span></code></pre></div>
<div class="section level2">
<h2 id="see-also">See Also<a class="anchor" aria-label="anchor" href="#see-also"></a>
</h2>
<p>See also <code><a href="../articles/specs.html">vignette("specs")</a></code>.</p>
</div>
<div class="section level2">
<h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<p>Blei, D. M., Ng, A. Y., &amp; Jordan, M. I. (2003). Latent dirichlet
allocation. <em>Journal of Machine Learning Research</em>, 3(Jan),
993–1022.</p>
<p>Peyré, G., &amp; Cuturi, M. (2019). Computational Optimal Transport:
With Applications to Data Science. <em>Foundations and Trends® in
Machine Learning</em>, 11(5–6), 355–607. <a href="https://doi.org/10.1561/2200000073" class="external-link uri">https://doi.org/10.1561/2200000073</a></p>
<p>Schmitz, M. A., Heitz, M., Bonneel, N., Ngolè, F., Coeurjolly, D.,
Cuturi, M., Peyré, G., &amp; Starck, J.-L. (2018). Wasserstein
dictionary learning: Optimal transport-based unsupervised nonlinear
dictionary learning. <em>SIAM Journal on Imaging Sciences</em>, 11(1),
643–678. <a href="https://doi.org/10.1137/17M1140431" class="external-link uri">https://doi.org/10.1137/17M1140431</a></p>
<p>Xie, F. (2025). Deriving the Gradients of Some Popular Optimal
Transport Algorithms (No. arXiv:2504.08722). <em>arXiv</em>. <a href="https://doi.org/10.48550/arXiv.2504.08722" class="external-link uri">https://doi.org/10.48550/arXiv.2504.08722</a></p>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Fangzhou Xie.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer>
</div>





  </body>
</html>
